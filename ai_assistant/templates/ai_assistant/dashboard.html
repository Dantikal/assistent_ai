{% extends 'base.html' %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å - StudySense{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ student.user.get_full_name }}!</h1>
        <p class="text-muted">–ì—Ä—É–ø–ø–∞: {{ student.group }}</p>
    </div>
    <div class="col-md-4 text-end">
        {% if student.telegram_chat_id %}
            <span class="badge bg-success">
                <i class="fas fa-telegram me-1"></i>Telegram –ø–æ–¥–∫–ª—é—á–µ–Ω
            </span>
        {% else %}
            <span class="badge bg-warning">
                <i class="fas fa-telegram me-1"></i>Telegram –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
            </span>
        {% endif %}
    </div>
</div>

<div class="row mt-4">
    <!-- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-calendar-day me-2"></i>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
                </h5>
            </div>
            <div class="card-body">
                {% if today_schedules %}
                    {% for schedule in today_schedules %}
                        <div class="schedule-card card mb-2 {% if next_class == schedule %}border-primary{% endif %}">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="card-title mb-1">{{ schedule.subject.name }}</h6>
                                        <p class="card-text text-muted mb-1">
                                            <i class="fas fa-user-tie me-1"></i>{{ schedule.subject.teacher.get_full_name }}
                                        </p>
                                        <p class="card-text text-muted mb-0">
                                            <i class="fas fa-clock me-1"></i>{{ schedule.start_time }} - {{ schedule.end_time }}
                                            <i class="fas fa-door-open ms-2 me-1"></i>{{ schedule.room }}
                                        </p>
                                    </div>
                                    {% if next_class == schedule %}
                                        <span class="badge bg-primary">–°–ª–µ–¥—É—é—â–∞—è</span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <p class="text-muted">–ù–∞ —Å–µ–≥–æ–¥–Ω—è –ø–∞—Ä –Ω–µ—Ç. –û—Ç–¥—ã—Ö–∞–π—Ç–µ! üòä</p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∏–∑—É—á–µ–Ω–∏—è -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-chart-line me-2"></i>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑—É—á–µ–Ω–Ω—ã–µ —Ç–µ–º—ã
                </h5>
            </div>
            <div class="card-body">
                {% if recent_progress %}
                    {% for progress in recent_progress %}
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <h6 class="mb-1">{{ progress.knowledge_card.title }}</h6>
                                <small class="text-muted">{{ progress.knowledge_card.subject.name }}</small>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-{{ progress.mastery_level|yesno:'success,warning,info,primary' }}">
                                    {{ progress.get_mastery_level_display }}
                                </span>
                                <br>
                                <small class="text-muted">{{ progress.access_count }} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</small>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <p class="text-muted">–í—ã –µ—â–µ –Ω–µ –∏–∑—É—á–∞–ª–∏ —Ç–µ–º—ã. –ù–∞—á–Ω–∏—Ç–µ —Å <a href="{% url 'knowledge_cards' %}">–∫–∞—Ä—Ç–æ—á–µ–∫ –∑–Ω–∞–Ω–∏–π</a>!</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-bolt me-2"></i>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'ai_chat' %}" class="btn btn-outline-primary w-100 h-100 d-flex flex-column align-items-center justify-content-center">
                            <i class="fas fa-robot fa-2x mb-2"></i>
                            –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å AI
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'knowledge_cards' %}" class="btn btn-outline-success w-100 h-100 d-flex flex-column align-items-center justify-content-center">
                            <i class="fas fa-book fa-2x mb-2"></i>
                            –ò–∑—É—á–∏—Ç—å —Ç–µ–º—ã
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'schedule' %}" class="btn btn-outline-info w-100 h-100 d-flex flex-column align-items-center justify-content-center">
                            <i class="fas fa-calendar fa-2x mb-2"></i>
                            –ü–æ–ª–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="/admin/" class="btn btn-outline-warning w-100 h-100 d-flex flex-column align-items-center justify-content-center">
                            <i class="fas fa-cog fa-2x mb-2"></i>
                            –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
