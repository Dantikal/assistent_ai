{% extends 'base.html' %}
{% load math_filters %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å - StudySense{% endblock %}

{% block extra_css %}
<style>
    body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
    }

    .main-container {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        margin: 20px auto;
        padding: 30px;
        max-width: 1200px;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è —Å–∏—è–Ω–∏—è –¥–ª—è —Ç–æ–ø-–∏–≥—Ä–æ–∫–æ–≤ */
    @keyframes glow {
        0% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 40px rgba(255, 215, 0, 0.4); }
        50% { box-shadow: 0 0 30px rgba(255, 215, 0, 1), 0 0 60px rgba(255, 215, 0, 0.6); }
        100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 40px rgba(255, 215, 0, 0.4); }
    }

    @keyframes rainbow {
        0% { filter: hue-rotate(0deg); }
        100% { filter: hue-rotate(360deg); }
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
    }

    @keyframes sparkle {
        0%, 100% { opacity: 0; }
        50% { opacity: 1; }
    }

    .profile-header {
        text-align: center;
        margin-bottom: 40px;
        position: relative;
    }

    .profile-title {
        font-size: 2.5rem;
        font-weight: bold;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 10px;
    }

    .avatar-container {
        position: relative;
        width: 150px;
        height: 150px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        transition: all 0.3s ease;
    }

    .avatar-container:hover {
        transform: scale(1.05);
    }

    /* –≠—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è —Ä–∞–Ω–≥–æ–≤ */
    .rank-iron {
        border: 5px solid #a0a0a0;
        background: linear-gradient(135deg, #d3d3d3 0%, #a0a0a0 100%);
        box-shadow: 0 0 20px rgba(160, 160, 160, 0.5);
    }

    .rank-bronze {
        border: 5px solid #cd7f32;
        background: linear-gradient(135deg, #e8b86f 0%, #cd7f32 100%);
        box-shadow: 0 0 25px rgba(205, 127, 50, 0.6);
    }

    .rank-silver {
        border: 5px solid #c0c0c0;
        background: linear-gradient(135deg, #f0f0f0 0%, #c0c0c0 100%);
        box-shadow: 0 0 30px rgba(192, 192, 192, 0.8);
    }

    .rank-gold {
        border: 5px solid #ffd700;
        background: linear-gradient(135deg, #ffed4e 0%, #ffd700 100%);
        box-shadow: 0 0 35px rgba(255, 215, 0, 0.8);
        animation: glow 2s ease-in-out infinite;
    }

    .rank-platinum {
        border: 5px solid #e5e4e2;
        background: linear-gradient(135deg, #f8f8f8 0%, #e5e4e2 100%);
        box-shadow: 0 0 40px rgba(229, 228, 226, 1), 0 0 60px rgba(100, 200, 255, 0.4);
        animation: glow 2.5s ease-in-out infinite;
    }

    .rank-diamond {
        border: 5px solid #00d4ff;
        background: linear-gradient(135deg, #87ceeb 0%, #00d4ff 100%);
        box-shadow: 0 0 45px rgba(0, 212, 255, 0.8), 0 0 70px rgba(0, 212, 255, 0.4);
        animation: glow 1.8s ease-in-out infinite;
    }

    .rank-master {
        border: 5px solid #9933ff;
        background: linear-gradient(135deg, #da70d6 0%, #9933ff 100%);
        box-shadow: 0 0 50px rgba(153, 51, 255, 0.8), 0 0 80px rgba(218, 112, 214, 0.4);
        animation: glow 1.5s ease-in-out infinite;
    }

    .rank-grandmaster {
        border: 5px solid #ff00ff;
        background: linear-gradient(135deg, #ff0080 0%, #ff00ff 50%, #00d4ff 100%);
        box-shadow: 0 0 60px rgba(255, 0, 255, 0.8), 0 0 90px rgba(255, 0, 128, 0.4);
        animation: glow 1s ease-in-out infinite, rainbow 3s linear infinite;
    }

    .avatar-image {
        width: 130px;
        height: 130px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid white;
    }

    .rank-badge {
        position: absolute;
        bottom: -5px;
        right: -5px;
        background: white;
        border-radius: 50%;
        padding: 8px;
        font-size: 30px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
        animation: float 3s ease-in-out infinite;
    }

    /* –ò—Å–∫—Ä—ã –¥–ª—è —Ç–æ–ø-—Ä–∞–Ω–≥–æ–≤ */
    .sparkle {
        position: absolute;
        width: 4px;
        height: 4px;
        background: white;
        border-radius: 50%;
        animation: sparkle 2s ease-in-out infinite;
    }

    .sparkle1 { top: 10%; left: 10%; animation-delay: 0s; }
    .sparkle2 { top: 20%; right: 15%; animation-delay: 0.5s; }
    .sparkle3 { bottom: 15%; left: 20%; animation-delay: 1s; }
    .sparkle4 { bottom: 25%; right: 10%; animation-delay: 1.5s; }

    .rank-info {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        padding: 25px;
        border-radius: 15px;
        margin: 20px 0;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        position: relative;
        overflow: hidden;
    }

    .rank-info::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transform: rotate(45deg);
        animation: shimmer 3s ease-in-out infinite;
    }

    @keyframes shimmer {
        0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }

    .rank-progress-bar {
        margin-top: 15px;
        height: 30px;
        background: #e0e0e0;
        border-radius: 15px;
        overflow: hidden;
        position: relative;
    }

    .rank-progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #4CAF50 0%, #45a049 50%, #4CAF50 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 14px;
        font-weight: bold;
        position: relative;
        overflow: hidden;
    }

    .rank-progress-fill::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
        animation: progress-shine 2s ease-in-out infinite;
    }

    @keyframes progress-shine {
        0% { left: -100%; }
        100% { left: 100%; }
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }

    .stat-item {
        background: white;
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .stat-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    }

    .stat-item.top-player {
        background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
        animation: glow 3s ease-in-out infinite;
    }

    .stat-value {
        font-size: 28px;
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
    }

    .stat-label {
        font-size: 14px;
        color: #666;
    }

    .achievement-card {
        background: white;
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }

    .achievement-card:hover {
        transform: translateX(10px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .achievement-icon {
        font-size: 24px;
        margin-right: 15px;
    }

    .points-display {
        font-size: 3rem;
        font-weight: bold;
        background: linear-gradient(135deg, #ffd700 0%, #ff6b6b 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-align: center;
        margin: 20px 0;
        animation: float 4s ease-in-out infinite;
    }

    .leaderboard-position {
        background: linear-gradient(135deg, #ff6b6b 0%, #ffd700 100%);
        color: white;
        padding: 10px 20px;
        border-radius: 25px;
        font-weight: bold;
        display: inline-block;
        margin: 10px 0;
        animation: glow 2s ease-in-out infinite;
    }

    .form-control:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
    }

    .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 25px;
        padding: 12px 30px;
        font-weight: bold;
        transition: all 0.3s ease;
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
    }

    .card {
        border: none;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
    }

    .card-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px 15px 0 0 !important;
        border: none;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 768px) {
        .main-container {
            margin: 10px;
            padding: 20px;
        }
        
        .profile-title {
            font-size: 2rem;
        }
        
        .avatar-container {
            width: 120px;
            height: 120px;
        }
        
        .avatar-image {
            width: 100px;
            height: 100px;
        }
        
        .stats-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="main-container">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è -->
    <div class="profile-header">
        <h1 class="profile-title">
            <i class="fas fa-user-circle me-2"></i>–ü—Ä–æ—Ñ–∏–ª—å —Å—Ç—É–¥–µ–Ω—Ç–∞
        </h1>
        {% if user.profile.is_top_player %}
            <div class="leaderboard-position">
                <i class="fas fa-trophy me-2"></i>–¢–æ–ø –∏–≥—Ä–æ–∫ #{{ user.profile.leaderboard_position }}
            </div>
        {% endif %}
    </div>

    <div class="row">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ü—Ä–æ—Ñ–∏–ª—å –∏ –∞–≤–∞—Ç–∞—Ä -->
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-user me-2"></i>–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                    </h5>
                </div>
                <div class="card-body">
                    {% if saved %}
                        <div class="alert alert-success" role="alert">
                            <i class="fas fa-check-circle me-2"></i>–ê–≤–∞—Ç–∞—Ä —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª—ë–Ω!
                        </div>
                    {% endif %}

                    <!-- –ê–≤–∞—Ç–∞—Ä —Å —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ —Ä–∞–Ω–≥–∞ -->
                    <div style="text-align: center; margin-bottom: 30px;">
                        <div class="avatar-container rank-{{ user.profile.get_rank_class }}" 
                             style="display: inline-block; position: relative;">
                            
                            <!-- –ò—Å–∫—Ä—ã –¥–ª—è —Ç–æ–ø-—Ä–∞–Ω–≥–æ–≤ -->
                            {% if user.profile.get_rank_class in 'gold platinum diamond master grandmaster' %}
                                <div class="sparkle sparkle1"></div>
                                <div class="sparkle sparkle2"></div>
                                <div class="sparkle sparkle3"></div>
                                <div class="sparkle sparkle4"></div>
                            {% endif %}
                            
                            {% if profile.avatar %}
                                <img src="{{ profile.avatar.url }}" alt="avatar" class="avatar-image">
                            {% else %}
                                <div style="width: 130px; height: 130px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: #f0f0f0;">
                                    <i class="fas fa-user" style="font-size: 50px; color: #ccc;"></i>
                                </div>
                            {% endif %}
                            
                            {% if user.profile.get_rank %}
                                <div class="rank-badge">{{ user.profile.get_rank.emoji }}</div>
                            {% endif %}
                        </div>
                    </div>

                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
                    <div class="mb-4 text-center">
                        <h4><strong>{{ user.username }}</strong></h4>
                        <p class="text-muted mb-2">
                            <i class="fas fa-envelope me-2"></i>{{ user.email }}
                        </p>
                    </div>

                    <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—á–∫–æ–≤ -->
                    <div class="points-display">
                        <i class="fas fa-star me-2"></i>{{ profile.points }}
                        <div style="font-size: 1rem; color: #666;">–æ—á–∫–æ–≤ –æ–ø—ã—Ç–∞</div>
                    </div>

                    <!-- –†–∞–Ω–≥ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å -->
                    <div class="rank-info">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                            <h6 style="margin: 0; color: #333; font-size: 1.2rem;">
                                {% if user.profile.get_rank %}
                                    {{ user.profile.get_rank.emoji }} {{ user.profile.get_rank.name }}
                                {% else %}
                                    <i class="fas fa-user-graduate me-2"></i>–ë–µ–∑ —Ä–∞–Ω–≥–∞
                                {% endif %}
                            </h6>
                            {% if user.profile.get_next_rank %}
                                <span style="font-size: 14px; color: #666;">
                                    –°–ª–µ–¥—É—é—â–∏–π: {{ user.profile.get_next_rank.emoji }} {{ user.profile.get_next_rank.name }}
                                </span>
                            {% endif %}
                        </div>
                        
                        <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞–Ω–≥—É -->
                        {% if user.profile.get_next_rank %}
                            <div style="font-size: 14px; color: #666; margin-bottom: 10px;">
                                –î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞–Ω–≥–∞: <strong>{{ user.profile.get_points_to_next_rank }}</strong> –æ—á–∫–æ–≤
                            </div>
                            <div class="rank-progress-bar">
                                <div class="rank-progress-fill" style="width: {{ user.profile.get_progress_percentage }}%;">
                                    {{ user.profile.get_progress_percentage }}%
                                </div>
                            </div>
                        {% else %}
                            <div style="font-size: 14px; color: #28a745; padding: 15px; text-align: center; background: #d4edda; border-radius: 10px; border: 1px solid #c3e6cb;">
                                <i class="fas fa-crown me-2"></i><strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–Ω–≥ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç!</strong>
                            </div>
                        {% endif %}
                    </div>

                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                    <div class="stats-grid">
                        <div class="stat-item {% if profile.correct_answers > 100 %}top-player{% endif %}">
                            <div class="stat-value">{{ profile.correct_answers }}</div>
                            <div class="stat-label">
                                <i class="fas fa-check-circle me-1"></i>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">{{ profile.wrong_answers }}</div>
                            <div class="stat-label">
                                <i class="fas fa-times-circle me-1"></i>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
                            </div>
                        </div>
                        <div class="stat-item {% if accuracy >= 80 %}top-player{% endif %}">
                            <div class="stat-value">
                                {% if profile.correct_answers|add:profile.wrong_answers > 0 %}
                                    {{ accuracy }}%
                                {% else %}
                                    0%
                                {% endif %}
                            </div>
                            <div class="stat-label">
                                <i class="fas fa-bullseye me-1"></i>–¢–æ—á–Ω–æ—Å—Ç—å
                            </div>
                        </div>
                        {% if user.profile.leaderboard_position %}
                        <div class="stat-item top-player">
                            <div class="stat-value">#{{ user.profile.leaderboard_position }}</div>
                            <div class="stat-label">
                                <i class="fas fa-trophy me-1"></i>–†–µ–π—Ç–∏–Ω–≥
                            </div>
                        </div>
                        {% endif %}
                    </div>

                    <!-- –§–æ—Ä–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞ -->
                    <hr class="my-4">
                    <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label class="form-label">
                                <i class="fas fa-camera me-2"></i>–ò–∑–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                            </label>
                            {{ form.avatar }}
                        </div>
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="fas fa-upload me-2"></i>–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å -->
        <div class="col-lg-6">
            <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-trophy me-2"></i>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                    </h5>
                </div>
                <div class="card-body">
                    {% if profile.correct_answers >= 100 %}
                        <div class="achievement-card">
                            <div class="d-flex align-items-center">
                                <span class="achievement-icon">üéØ</span>
                                <div>
                                    <strong>–ú–µ—Ç–∫–∏–π —Å—Ç—Ä–µ–ª–æ–∫</strong>
                                    <div class="text-muted small">100 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    
                    {% if profile.points >= 500 %}
                        <div class="achievement-card">
                            <div class="d-flex align-items-center">
                                <span class="achievement-icon">‚≠ê</span>
                                <div>
                                    <strong>–û–ø—ã—Ç–Ω—ã–π —Å—Ç—É–¥–µ–Ω—Ç</strong>
                                    <div class="text-muted small">500 –æ—á–∫–æ–≤ –æ–ø—ã—Ç–∞</div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    
                    {% if accuracy >= 80 %}
                        <div class="achievement-card">
                            <div class="d-flex align-items-center">
                                <span class="achievement-icon">üéñÔ∏è</span>
                                <div>
                                    <strong>–ú–∞—Å—Ç–µ—Ä —Ç–æ—á–Ω–æ—Å—Ç–∏</strong>
                                    <div class="text-muted small">80%+ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    
                    {% if user.profile.get_rank_class in 'platinum diamond master grandmaster' %}
                        <div class="achievement-card">
                            <div class="d-flex align-items-center">
                                <span class="achievement-icon">üëë</span>
                                <div>
                                    <strong>–≠–ª–∏—Ç–∞ —Å–∏—Å—Ç–µ–º—ã</strong>
                                    <div class="text-muted small">–í—ã—Å–æ–∫–∏–π —Ä–∞–Ω–≥ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    
                    {% if not profile.correct_answers >= 100 and not profile.points >= 500 and not accuracy >= 80 %}
                        <div class="text-center py-4">
                            <i class="fas fa-lock fa-2x text-muted mb-3"></i>
                            <p class="text-muted">–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —É—á–∏—Ç—å—Å—è, —á—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è!</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- –ü—Ä–µ–¥–º–µ—Ç—ã –∏ –æ—á–∫–∏ -->
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-book me-2"></i>–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º
                    </h5>
                </div>
                <div class="card-body">
                    {% if subject_scores %}
                        {% for score in subject_scores %}
                            {% with total_answers=score.correct_answers|add:score.wrong_answers %}
                            {% with percentage=score.correct_answers|percentage:total_answers %}
                            <div class="mb-3">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <strong>{{ score.subject.name }}</strong>
                                    <span class="badge bg-primary">{{ score.points }} –æ—á–∫–æ–≤</span>
                                </div>
                                <div class="progress" style="height: 8px;">
                                    <div class="progress-bar" role="progressbar" 
                                         style="width: {% if total_answers > 0 %}{{ percentage|floatformat:0 }}{% else %}0{% endif %}%">
                                    </div>
                                </div>
                                <small class="text-muted">
                                    {{ score.correct_answers }} –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö, {{ score.wrong_answers }} –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
                                </small>
                            </div>
                            {% endwith %}
                            {% endwith %}
                        {% endfor %}
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-graduation-cap fa-2x text-muted mb-3"></i>
                            <p class="text-muted">–ù–∞—á–Ω–∏—Ç–µ –∏–∑—É—á–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å!</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-bolt me-2"></i>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
                    </h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a href="{% url 'knowledge_cards' %}" class="btn btn-outline-primary">
                            <i class="fas fa-book-open me-2"></i>–ò–∑—É—á–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏
                        </a>
                        <a href="{% url 'ai_chat' %}" class="btn btn-outline-success">
                            <i class="fas fa-robot me-2"></i>–°–ø—Ä–æ—Å–∏—Ç—å AI
                        </a>
                        <a href="{% url 'leaderboard' %}" class="btn btn-outline-warning">
                            <i class="fas fa-trophy me-2"></i>–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤
                        </a>
                        <a href="{% url 'dashboard' %}" class="btn btn-outline-info">
                            <i class="fas fa-home me-2"></i>–ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
