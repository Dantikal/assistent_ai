{% extends 'base.html' %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å - StudySense{% endblock %}

{% block extra_css %}
<style>
    .avatar-container {
        position: relative;
        width: 100px;
        height: 100px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* IRON (–ñ–µ–ª–µ–∑–æ) - —Å–µ—Ä—ã–π */
    .rank-iron {
        border: 4px solid #a0a0a0;
        background: linear-gradient(135deg, #d3d3d3 0%, #a0a0a0 100%);
        box-shadow: 0 0 15px rgba(160, 160, 160, 0.5), inset 0 0 10px rgba(0, 0, 0, 0.1);
    }

    /* BRONZE (–ë—Ä–æ–Ω–∑–∞) - –∫–æ—Ä–∏—á–Ω–µ–≤—ã–π */
    .rank-bronze {
        border: 4px solid #cd7f32;
        background: linear-gradient(135deg, #e8b86f 0%, #cd7f32 100%);
        box-shadow: 0 0 20px rgba(205, 127, 50, 0.6), inset 0 0 10px rgba(0, 0, 0, 0.2);
    }

    /* SILVER (–°–µ—Ä–µ–±—Ä–æ) - —Å–µ—Ä–µ–±—Ä–∏—Å—Ç—ã–π */
    .rank-silver {
        border: 4px solid #c0c0c0;
        background: linear-gradient(135deg, #f0f0f0 0%, #c0c0c0 100%);
        box-shadow: 0 0 25px rgba(192, 192, 192, 0.8), inset 0 0 10px rgba(255, 255, 255, 0.3);
    }

    /* GOLD (–ó–æ–ª–æ—Ç–æ) - –∑–æ–ª–æ—Ç–æ–π */
    .rank-gold {
        border: 4px solid #ffd700;
        background: linear-gradient(135deg, #ffed4e 0%, #ffd700 100%);
        box-shadow: 0 0 30px rgba(255, 215, 0, 0.8), 0 0 40px rgba(255, 215, 0, 0.3), inset 0 0 10px rgba(255, 255, 255, 0.3);
    }

    /* PLATINUM (–ü–ª–∞—Ç–∏–Ω–∞) - —Å–µ—Ä–µ–±—Ä–∏—Å—Ç–æ-–≥–æ–ª—É–±–æ–π */
    .rank-platinum {
        border: 4px solid #e5e4e2;
        background: linear-gradient(135deg, #f8f8f8 0%, #e5e4e2 100%);
        box-shadow: 0 0 35px rgba(229, 228, 226, 1), 0 0 50px rgba(100, 200, 255, 0.4), inset 0 0 15px rgba(255, 255, 255, 0.5);
    }

    /* DIAMOND (–ê–ª–º–∞–∑) - –≥–æ–ª—É–±–æ–π */
    .rank-diamond {
        border: 4px solid #00d4ff;
        background: linear-gradient(135deg, #87ceeb 0%, #00d4ff 100%);
        box-shadow: 0 0 40px rgba(0, 212, 255, 0.8), 0 0 60px rgba(0, 212, 255, 0.4), inset 0 0 20px rgba(255, 255, 255, 0.4);
    }

    /* MASTER (–ú–∞—Å—Ç–µ—Ä) - —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π */
    .rank-master {
        border: 4px solid #9933ff;
        background: linear-gradient(135deg, #da70d6 0%, #9933ff 100%);
        box-shadow: 0 0 40px rgba(153, 51, 255, 0.8), 0 0 60px rgba(218, 112, 214, 0.4), inset 0 0 15px rgba(255, 255, 255, 0.2);
    }

    /* GRANDMASTER - —Ä–∞–¥—É–∂–Ω—ã–π */
    .rank-grandmaster {
        border: 4px solid #ff00ff;
        background: linear-gradient(135deg, #ff0080 0%, #ff00ff 50%, #00d4ff 100%);
        box-shadow: 0 0 50px rgba(255, 0, 255, 0.8), 0 0 70px rgba(255, 0, 128, 0.4), inset 0 0 20px rgba(255, 255, 255, 0.3);
    }

    .avatar-image {
        width: 90px;
        height: 90px;
        border-radius: 50%;
        object-fit: cover;
    }

    .rank-badge {
        position: absolute;
        bottom: -5px;
        right: -5px;
        background: white;
        border-radius: 50%;
        padding: 5px;
        font-size: 24px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    }

    .rank-info {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        padding: 15px;
        border-radius: 10px;
        margin-top: 15px;
    }

    .rank-progress-bar {
        margin-top: 10px;
        height: 25px;
        background: #e0e0e0;
        border-radius: 5px;
        overflow: hidden;
    }

    .rank-progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #4CAF50 0%, #45a049 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 12px;
        font-weight: bold;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 10px;
        margin-top: 15px;
    }

    .stat-item {
        background: white;
        padding: 12px;
        border-radius: 8px;
        text-align: center;
        border-left: 4px solid #007bff;
    }

    .stat-value {
        font-size: 20px;
        font-weight: bold;
        color: #333;
    }

    .stat-label {
        font-size: 12px;
        color: #666;
        margin-top: 5px;
    }
</style>
{% endblock %}

{% block content %}
<div class="row">
    <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ü—Ä–æ—Ñ–∏–ª—å –∏ –∞–≤–∞—Ç–∞—Ä -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">üéØ –ü—Ä–æ—Ñ–∏–ª—å</h5>
            </div>
            <div class="card-body">
                {% if saved %}
                    <div class="alert alert-success" role="alert">‚úÖ –ê–≤–∞—Ç–∞—Ä –æ–±–Ω–æ–≤–ª—ë–Ω</div>
                {% endif %}

                <!-- –ê–≤–∞—Ç–∞—Ä —Å —Ä–∞–º–∫–æ–π —Ä–∞–Ω–≥–∞ -->
                <div style="text-align: center; margin-bottom: 20px;">
                    <div class="avatar-container rank-{{ user.profile.get_rank_class }} me-3" style="display: inline-block; position: relative;">
                        {% if profile.avatar %}
                            <img src="{{ profile.avatar.url }}" alt="avatar" class="avatar-image">
                        {% else %}
                            <div style="width: 90px; height: 90px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: #f0f0f0;">
                                <i class="fas fa-user" style="font-size: 40px; color: #ccc;"></i>
                            </div>
                        {% endif %}
                        {% if user.profile.get_rank %}
                            <div class="rank-badge">{{ user.profile.get_rank.emoji }}</div>
                        {% endif %}
                    </div>
                </div>

                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
                <div class="mb-3">
                    <h6><strong>{{ user.username }}</strong></h6>
                    <p class="text-muted" style="margin-bottom: 5px;">üìß {{ user.email }}</p>
                </div>

                <!-- –†–∞–Ω–≥ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å -->
                <div class="rank-info">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                        <h6 style="margin: 0; color: #333;">
                            {% if user.profile.get_rank %}
                                {{ user.profile.get_rank.emoji }} {{ user.profile.get_rank.name }}
                            {% else %}
                                –ë–µ–∑ —Ä–∞–Ω–≥–∞
                            {% endif %}
                        </h6>
                        <span style="font-size: 18px; font-weight: bold; color: #ffd700;">‚≠ê {{ profile.points }}</span>
                    </div>
                    
                    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞–Ω–≥—É -->
                    {% if user.profile.get_next_rank %}
                        <div style="font-size: 12px; color: #666; margin-bottom: 8px;">
                            –î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞–Ω–≥–∞: <strong>{{ user.profile.get_points_to_next_rank }}</strong> –æ—á–∫–æ–≤
                        </div>
                        <div class="rank-progress-bar">
                            <div class="rank-progress-fill" style="width: {{ user.profile.get_progress_percentage }}%;">
                                {{ user.profile.get_progress_percentage }}%
                            </div>
                        </div>
                    {% else %}
                        <div style="font-size: 12px; color: #666; padding: 10px; text-align: center; background: #e8f5e9; border-radius: 5px;">
                            üëë –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–Ω–≥ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç!
                        </div>
                    {% endif %}
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">{{ profile.correct_answers }}</div>
                        <div class="stat-label">‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ profile.wrong_answers }}</div>
                        <div class="stat-label">‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">
                            {% if profile.correct_answers|add:profile.wrong_answers > 0 %}
                                {{ accuracy }}%
                            {% else %}
                                0%
                            {% endif %}
                        </div>
                        <div class="stat-label">üéØ –¢–æ—á–Ω–æ—Å—Ç—å</div>
                    </div>
                </div>

                <!-- –§–æ—Ä–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞ -->
                <hr class="my-4">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label class="form-label">üì∑ –ò–∑–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</label>
                        {{ form.avatar }}
                        {% if form.avatar.errors %}
                            <div class="text-danger small mt-1">{{ form.avatar.errors }}</div>
                        {% endif %}
                    </div>
                    <button type="submit" class="btn btn-primary w-100">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</button>
                </form>
            </div>
        </div>
    </div>

    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –°–∏—Å—Ç–µ–º–∞ —Ä–∞–Ω–≥–æ–≤ -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">üìä –°–∏—Å—Ç–µ–º–∞ —Ä–∞–Ω–≥–æ–≤</h5>
            </div>
            <div class="card-body">
                <p class="text-muted mb-3">–î–æ—Å—Ç–∏–≥–∞–π—Ç–µ –Ω–æ–≤—ã–µ —Ä–∞–Ω–≥–∏, –Ω–∞–±–∏—Ä–∞—è –æ—á–∫–∏ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã!</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                    <!-- IRON -->
                    <div style="padding: 12px; background: #f5f5f5; border-radius: 8px; border-left: 4px solid #a0a0a0;">
                        <div style="font-size: 24px;">ü•â</div>
                        <div style="font-weight: bold; font-size: 14px;">IRON</div>
                        <div style="font-size: 12px; color: #666;">0 - 500 –æ—á–∫–æ–≤</div>
                    </div>

                    <!-- BRONZE -->
                    <div style="padding: 12px; background: #fef3f0; border-radius: 8px; border-left: 4px solid #cd7f32;">
                        <div style="font-size: 24px;">ü•à</div>
                        <div style="font-weight: bold; font-size: 14px;">BRONZE</div>
                        <div style="font-size: 12px; color: #666;">500 - 2,000</div>
                    </div>

                    <!-- SILVER -->
                    <div style="padding: 12px; background: #f0f0f5; border-radius: 8px; border-left: 4px solid #c0c0c0;">
                        <div style="font-size: 24px;">ü•â</div>
                        <div style="font-weight: bold; font-size: 14px;">SILVER</div>
                        <div style="font-size: 12px; color: #666;">2,000 - 5,000</div>
                    </div>

                    <!-- GOLD -->
                    <div style="padding: 12px; background: #fffef0; border-radius: 8px; border-left: 4px solid #ffd700;">
                        <div style="font-size: 24px;">ü•à</div>
                        <div style="font-weight: bold; font-size: 14px;">GOLD</div>
                        <div style="font-size: 12px; color: #666;">5,000 - 10,000</div>
                    </div>

                    <!-- PLATINUM -->
                    <div style="padding: 12px; background: #f8f8f8; border-radius: 8px; border-left: 4px solid #e5e4e2;">
                        <div style="font-size: 24px;">ü•á</div>
                        <div style="font-weight: bold; font-size: 14px;">PLATINUM</div>
                        <div style="font-size: 12px; color: #666;">10,000 - 25,000</div>
                    </div>

                    <!-- DIAMOND -->
                    <div style="padding: 12px; background: #e0f7ff; border-radius: 8px; border-left: 4px solid #00d4ff;">
                        <div style="font-size: 24px;">ü•á</div>
                        <div style="font-weight: bold; font-size: 14px;">DIAMOND</div>
                        <div style="font-size: 12px; color: #666;">25,000 - 50,000</div>
                    </div>

                    <!-- MASTER -->
                    <div style="padding: 12px; background: #f3e5ff; border-radius: 8px; border-left: 4px solid #9933ff;">
                        <div style="font-size: 24px;">üëë</div>
                        <div style="font-weight: bold; font-size: 14px;">MASTER</div>
                        <div style="font-size: 12px; color: #666;">50,000 - 100,000</div>
                    </div>

                    <!-- GRANDMASTER -->
                    <div style="padding: 12px; background: linear-gradient(135deg, #ffe0ff 0%, #e0f7ff 100%); border-radius: 8px; border-left: 4px solid #ff00ff;">
                        <div style="font-size: 24px;">üëë</div>
                        <div style="font-weight: bold; font-size: 14px;">GRANDMASTER</div>
                        <div style="font-size: 12px; color: #666;">100,000+</div>
                    </div>
                </div>

                <div style="margin-top: 15px; padding: 12px; background: #e3f2fd; border-radius: 8px; border-left: 4px solid #2196f3;">
                    <strong>üí° –°–æ–≤–µ—Ç:</strong> –ö–∞–∂–¥—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–∞–µ—Ç –≤–∞–º –æ—á–∫–∏! –î–æ—Å—Ç–∏–≥–∞–π—Ç–µ –Ω–æ–≤—ã–µ —Ä–∞–Ω–≥–∏ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ —ç–∫—Å–∫lus–∏–≤–Ω—ã–µ —Ä–∞–º–∫–∏ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞.
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
